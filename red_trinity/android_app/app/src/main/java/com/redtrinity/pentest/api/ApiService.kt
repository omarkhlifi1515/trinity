package com.redtrinity.pentest.api

import com.redtrinity.pentest.Config
import com.redtrinity.pentest.model.*
import retrofit2.Response
import retrofit2.http.*

interface ApiService {
    @GET(Config.API_HEALTH)
    suspend fun healthCheck(): Response<HealthResponse>
    
    @GET(Config.API_TOOLS_LIST)
    @Headers("Authorization: ${Config.AUTH_TOKEN}")
    suspend fun listTools(): Response<ToolsResponse>
    
    @POST(Config.API_EXECUTE)
    @Headers("Authorization: ${Config.AUTH_TOKEN}")
    suspend fun executeCommand(@Body request: ExecuteRequest): Response<ExecuteResponse>
    
    @GET(Config.API_HISTORY)
    @Headers("Authorization: ${Config.AUTH_TOKEN}")
    suspend fun getHistory(@Query("limit") limit: Int = 50): Response<HistoryResponse>
    
    @POST(Config.API_SESSION_CREATE)
    @Headers("Authorization: ${Config.AUTH_TOKEN}")
    suspend fun createSession(): Response<SessionResponse>
    
    @GET(Config.API_SYSTEM_INFO)
    @Headers("Authorization: ${Config.AUTH_TOKEN}")
    suspend fun getSystemInfo(): Response<SystemInfoResponse>
}

